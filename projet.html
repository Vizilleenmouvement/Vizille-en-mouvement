<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projet 2026-2032 ‚Äì Vizille en Mouvement</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+3:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    
    <style>
        :root {
            --bleu-vizille: #1a3a5c; --bleu-clair: #2d5a87; --or-clair: #c9a227;
            --gris-doux: #f0f0f0; --gris-texte: #555; --blanc-casse: #fafafa;
            --violet-objectif: #8e44ad; --vert-engagement: #27ae60;
            --sarcelle: #16a085; --sarcelle-fonce: #0e6655;
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1); --shadow-lg: 0 8px 24px rgba(0,0,0,0.15);
        }
        body { padding-top: 110px; font-family: 'Source Sans 3', sans-serif; margin: 0; background: var(--blanc-casse); }
        
        /* Hero */
        .projet-hero { background: linear-gradient(135deg, var(--bleu-vizille), var(--bleu-clair)); color: white; padding: 2rem 1rem; text-align: center; }
        .projet-hero .logo-pulse { width: 120px; margin-bottom: 1rem; animation: pulse 2s ease-in-out infinite; filter: drop-shadow(0 4px 12px rgba(201, 162, 39, 0.5)); }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .projet-hero h1 { font-family: 'Playfair Display', serif; font-size: 2rem; margin: 0 0 0.5rem 0; }
        .projet-hero .slogan { color: var(--or-clair); font-size: 1.1rem; margin: 0; }
        
        /* Bouton Admin */
        .admin-btn { position: absolute; top: 1rem; right: 1rem; background: rgba(255,255,255,0.2); border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 1.2rem; cursor: pointer; transition: all 0.3s; text-decoration: none; display: flex; align-items: center; justify-content: center; }
        .admin-btn:hover { background: rgba(255,255,255,0.4); transform: rotate(90deg); }
        .projet-hero { position: relative; }
        
        /* Onglets th√®mes */
        .tabs-container { background: white; border-bottom: 2px solid var(--gris-doux); position: sticky; top: 110px; z-index: 100; }
        .tabs { max-width: 1400px; margin: 0 auto; display: flex; overflow-x: auto; justify-content: center; flex-wrap: wrap; gap: 0.5rem; padding: 0.8rem 1rem; }
        .tab { 
            padding: 0.7rem 1.2rem; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            gap: 0.4rem; 
            white-space: nowrap; 
            font-weight: 600; 
            color: white; 
            font-size: 0.95rem; 
            transition: all 0.2s; 
            border-radius: 8px;
            border: 2px solid transparent;
            opacity: 0.85;
        }
        .tab:hover { opacity: 1; transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .tab.active { opacity: 1; transform: scale(1.05); box-shadow: var(--shadow-lg); border-color: rgba(255,255,255,0.5); }
        .tab .badge { background: rgba(255,255,255,0.3); padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.8rem; font-weight: 700; }
        
        /* Couleurs par th√®me */
        .tab[data-theme="Transition √©cologique"] { background: linear-gradient(135deg, #1e8449, #27ae60); }
        .tab[data-theme="Enfance/Jeunesse"] { background: linear-gradient(135deg, #2471a3, #3498db); }
        .tab[data-theme="Mobilit√©s"] { background: linear-gradient(135deg, #138d75, #1abc9c); }
        .tab[data-theme="Tranquillit√© publique"] { background: linear-gradient(135deg, #1c2833, #2c3e50); }
        .tab[data-theme="Urbanisme"] { background: linear-gradient(135deg, #283747, #34495e); }
        .tab[data-theme="Travaux"] { background: linear-gradient(135deg, #5d6d7e, #7f8c8d); }
        .tab[data-theme="Sant√©"] { background: linear-gradient(135deg, #b03a5b, #e91e63); }
        .tab[data-theme="M√©tropole"] { background: linear-gradient(135deg, #0097a7, #00bcd4); }
        .tab[data-theme="Concertation citoyenne"] { background: linear-gradient(135deg, #0e6655, #16a085); }
        
        /* BANDEAU LEITMOTIV - EN PREMIER pour Concertation */
        .leitmotiv-banner { display: none; background: linear-gradient(135deg, var(--sarcelle), var(--sarcelle-fonce)); color: white; padding: 1.2rem 2rem; text-align: center; }
        .leitmotiv-banner.visible { display: block; }
        .leitmotiv-banner h2 { margin: 0 0 0.3rem 0; font-size: 1.1rem; font-weight: 700; }
        .leitmotiv-banner p { margin: 0; opacity: 0.9; font-size: 0.9rem; }
        
        /* SOUS-ONGLETS - EN DESSOUS du bandeau */
        .subtabs-container { display: none; background: white; padding: 1rem 0; border-bottom: 1px solid var(--gris-doux); }
        .subtabs-container.visible { display: block; }
        .subtabs { max-width: 1400px; margin: 0 auto; display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap; padding: 0 1rem; }
        .subtab { padding: 0.5rem 1rem; cursor: pointer; border-radius: 20px; font-size: 0.85rem; background: var(--gris-doux); color: var(--gris-texte); transition: all 0.2s; border: 2px solid transparent; }
        .subtab:hover { border-color: var(--sarcelle); }
        .subtab.active { background: var(--sarcelle); color: white; }
        
        /* Bandeau th√®me (autres th√®mes) */
        .theme-banner-container { max-width: 1400px; margin: 0 auto; padding: 1rem 1rem 0; }
        .theme-banner { background: linear-gradient(135deg, var(--bleu-vizille), var(--bleu-clair)); color: white; padding: 1rem 1.5rem; border-radius: 12px; display: flex; align-items: center; gap: 1rem; }
        .theme-banner .icon { font-size: 2.5rem; }
        .theme-banner .text h2 { font-family: 'Playfair Display', serif; font-size: 1.5rem; margin: 0 0 0.3rem 0; }
        .theme-banner .text p { opacity: 0.9; font-size: 0.95rem; margin: 0; }
        
        /* Contenu axe (Concertation) */
        .axe-content { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .axe-objectif { background: linear-gradient(135deg, #5d6d7e, #4a5568); color: white; padding: 1.5rem 2rem; border-radius: 12px; margin-bottom: 1.5rem; }
        .axe-objectif h3 { margin: 0 0 0.5rem 0; font-size: 1.3rem; }
        .axe-objectif p { margin: 0; font-size: 1rem; opacity: 0.95; }
        .axe-engagements h4 { color: var(--vert-engagement); font-size: 1.1rem; margin: 0 0 1rem 0; }
        .engagement-item { background: white; border-left: 4px solid var(--vert-engagement); padding: 1rem 1.5rem; margin-bottom: 1rem; border-radius: 0 8px 8px 0; box-shadow: var(--shadow-md); }
        .engagement-item h5 { margin: 0 0 0.3rem 0; color: var(--bleu-vizille); font-size: 1rem; }
        .engagement-item p { margin: 0; color: var(--gris-texte); line-height: 1.5; font-size: 0.95rem; }
        
        /* Compteur + grille cartes (autres th√®mes) */
        .results-count { text-align: center; padding: 1rem; color: var(--gris-texte); font-size: 0.9rem; }
        .cards-container { max-width: 1400px; margin: 0 auto; padding: 0 1rem 2rem; }
        .cards-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; }
        .card { background: white; border-radius: 12px; box-shadow: var(--shadow-md); overflow: hidden; transition: all 0.3s; cursor: pointer; }
        .card:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg); }
        .card-header { padding: 1rem 1.2rem; background: linear-gradient(135deg, var(--bleu-vizille), var(--bleu-clair)); color: white; }
        .card-header h3 { font-size: 1rem; line-height: 1.4; margin: 0; }
        .card-body { padding: 1rem 1.2rem; }
        .card-body p { font-size: 0.9rem; color: var(--gris-texte); line-height: 1.5; margin: 0; }
        .card-body .meta { margin-top: 0.8rem; padding-top: 0.8rem; border-top: 1px solid var(--gris-doux); font-size: 0.8rem; }
        .card-body .meta span { display: inline-block; background: var(--gris-doux); padding: 0.2rem 0.5rem; border-radius: 4px; margin: 0.2rem 0.2rem 0 0; }
        .card.objectif .card-header { background: linear-gradient(135deg, #6c3483, var(--violet-objectif)); }
        .card.objectif { border-left: 4px solid var(--violet-objectif); }
        .card.engagement .card-header { background: linear-gradient(135deg, #1e8449, var(--vert-engagement)); }
        .card.engagement { border-left: 4px solid var(--vert-engagement); }
        
        @media (max-width: 768px) {
            body { padding-top: 80px; }
            .tabs-container { top: 80px; }
            .projet-hero .logo-pulse { width: 80px; }
            .projet-hero h1 { font-size: 1.5rem; }
            .cards-grid { grid-template-columns: 1fr; }
            .subtab { font-size: 0.8rem; padding: 0.4rem 0.8rem; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-top"><p>Vizille en Mouvement - Municipales 2026</p></div>
        <div class="header-main">
            <a href="index.html"><img src="images/logo.png" alt="Vizille en Mouvement" class="nav-header-logo"></a>
            <button class="menu-toggle" aria-label="Menu">‚ò∞</button>
            <nav><ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="bilan.html">Bilan</a></li>
                <li><a href="projet.html" class="active">Projet</a></li>
                <li><a href="blog.html">Actualit√©s</a></li>
                <li><a href="equipe.html">√âquipe</a></li>
            </ul></nav>
        </div>
    </header>
    <script src="js/menu-mobile.js"></script>

    <section class="projet-hero">
        <a href="admin.html" class="admin-btn" title="Administration">‚öôÔ∏è</a>
        <img src="images/logo.png" alt="Vizille en Mouvement" class="logo-pulse">
        <h1>Projet 2026-2032</h1>
        <p class="slogan">Nos engagements pour Vizille</p>
    </section>
    
    <div class="tabs-container"><div class="tabs" id="tabs"></div></div>
    
    <!-- ORDRE : 1) Bandeau leitmotiv  2) Sous-onglets -->
    <div class="leitmotiv-banner" id="leitmotiv-banner">
        <h2>üó£Ô∏è ANCRER LE PROGRAMME MUNICIPAL SUR LA BASE DE L'√âDUCATION POPULAIRE</h2>
        <p>‚Üí Renforcer la d√©mocratie ‚Ä¢ L'√©mancipation individuelle et collective ‚Ä¢ La concertation citoyenne</p>
    </div>
    <div class="subtabs-container" id="subtabs-container"><div class="subtabs" id="subtabs"></div></div>
    
    <!-- Bandeau th√®me pour autres th√®mes -->
    <div class="theme-banner-container" id="theme-banner-container"></div>
    
    <!-- Contenu principal -->
    <div id="main-content"></div>

<script>
const THEMES = [
    { id: 'Transition √©cologique', label: 'Transition √©cologique', icon: 'üå±' },
    { id: 'Enfance/Jeunesse', label: 'Enfance/Jeunesse', icon: 'üë∂' },
    { id: 'Mobilit√©s', label: 'Mobilit√©s', icon: 'üö¥' },
    { id: 'Tranquillit√© publique', label: 'Tranquillit√© publique', icon: 'üõ°Ô∏è' },
    { id: 'Urbanisme', label: 'Urbanisme', icon: 'üèóÔ∏è' },
    { id: 'Travaux', label: 'Travaux', icon: 'üîß' },
    { id: 'Sant√©', label: 'Sant√©', icon: 'üè•' },
    { id: 'M√©tropole', label: 'M√©tropole', icon: 'üèõÔ∏è' },
    { id: 'Concertation citoyenne', label: 'Concertation citoyenne', icon: 'üó£Ô∏è', special: true }
];

const THEME_DESC = {
    'Transition √©cologique': '2 objectifs et 9 engagements pour l\'environnement et le climat',
    'Enfance/Jeunesse': 'Accompagner les enfants et les jeunes',
    'Mobilit√©s': 'Faciliter les d√©placements de tous',
    'Tranquillit√© publique': 'Assurer la s√©curit√© et la tranquillit√©',
    'Urbanisme': 'Revitaliser le centre-ville et accompagner les projets urbains',
    'Travaux': 'Moderniser les infrastructures et le patrimoine communal',
    'Sant√©': 'Favoriser l\'acc√®s aux soins',
    'M√©tropole': 'Renforcer notre place dans la M√©tropole',
    'Concertation citoyenne': 'Ancrer le programme sur la base de l\'√©ducation populaire'
};

// Les 5 axes avec contenu complet
const AXES = [
    { 
        id: 'Axe 1', label: '1Ô∏è‚É£ D√©mocratie locale',
        titre: 'D√©mocratie locale et concertation citoyenne',
        objectif: 'Faire vivre une d√©mocratie active, inclusive et √©mancipatrice',
        engagements: [
            { titre: 'Conseils de quartier', desc: 'Cr√©er des conseils de quartier pour associer les habitants aux d√©cisions locales.' },
            { titre: 'Lieu d\'√©coute et de concertation', desc: 'Ouvrir un lieu d√©di√© √† l\'√©coute, aux ateliers participatifs, aux d√©bats citoyens et aux formations.' }
        ]
    },
    { 
        id: 'Axe 2', label: '2Ô∏è‚É£ √âducation populaire',
        titre: '√âducation populaire et culture pour tous',
        objectif: 'Garantir l\'acc√®s √† une culture critique, √©mancipatrice et accessible √† tous',
        engagements: [
            { titre: 'Centre d\'√©ducation populaire', desc: 'Cr√©er un centre permanent (style MJC) pour ateliers, formations et rencontres.' },
            { titre: 'Caf√©-d√©bats et cin√©-d√©bats', desc: 'Organiser r√©guli√®rement des d√©bats sur les enjeux sociaux, environnementaux et politiques.' },
            { titre: 'Soutien aux associations', desc: 'Renforcer le soutien aux associations d\'√©ducation populaire (L\'Escale...).' },
            { titre: 'R√©sidences d\'artistes', desc: 'Accueillir des r√©sidences d\'artistes et chercheurs dans les √©coles et quartiers.' }
        ]
    },
    { 
        id: 'Axe 3', label: '3Ô∏è‚É£ Jeunesse',
        titre: 'Jeunesse et √©mancipation',
        objectif: 'Donner aux jeunes les moyens de devenir acteurs de leur vie et territoire',
        engagements: [
            { titre: 'Conseil Municipal des Jeunes', desc: 'Cr√©er un CMJ pour impliquer les jeunes dans la vie de la commune.' },
            { titre: 'Ateliers pens√©e critique', desc: 'Proposer des ateliers d\'autod√©fense intellectuelle et de pens√©e critique.' },
            { titre: 'Chantiers jeunes participatifs', desc: 'Mettre en place des chantiers jeunes (service civique local).' }
        ]
    },
    { 
        id: 'Axe 4', label: '4Ô∏è‚É£ Lutte in√©galit√©s',
        titre: 'Lutte contre les in√©galit√©s et √©mancipation sociale',
        objectif: 'L\'√©ducation populaire comme outil d\'√©mancipation pour les plus √©loign√©s des droits',
        engagements: [
            { titre: 'Apprentissage du fran√ßais', desc: 'Soutenir l\'apprentissage du fran√ßais pour tous.' },
            { titre: 'Ateliers droits et institutions', desc: 'Comprendre ses droits, les aides sociales et le fonctionnement des institutions.' },
            { titre: 'Lieux de convivialit√© gratuits', desc: 'D√©velopper des lieux gratuits : jardins partag√©s, m√©diath√®que, L\'Escale...' },
            { titre: 'Conseil Local de Sant√© Mentale', desc: 'Cr√©er un CLSM comme outil de d√©mocratie en sant√©.' }
        ]
    },
    { 
        id: 'Axe 5', label: '5Ô∏è‚É£ Transition',
        titre: 'Transition √©cologique et savoirs partag√©s',
        objectif: 'Faire de la transition un projet collectif compris et ma√Ætris√© localement',
        engagements: [
            { titre: 'Actions p√©dagogiques Plan Climat', desc: 'Approfondir les actions p√©dagogiques du Plan Climat municipal.' },
            { titre: 'Formations citoyennes climat', desc: 'Organiser des formations sur les enjeux climatiques.' },
            { titre: 'Exp√©rimentations collectives', desc: 'Potagers urbains, compostage, r√©duction des d√©chets...' },
            { titre: 'Projets dans les √©coles', desc: 'Projets p√©dagogiques sur l\'environnement.' },
            { titre: 'Caf√©-d√©bats sant√©-environnement', desc: 'D√©bats sur pollution, habitat, risques professionnels.' }
        ]
    }
];

let allData = [];
let currentTheme = 'Transition √©cologique';
let currentAxe = 'Axe 1';

async function init() {
    const response = await fetch('projets.json?v=' + Date.now());
    allData = await response.json();
    renderTabs();
    render();
}

function renderTabs() {
    let html = '';
    THEMES.forEach(t => {
        const count = allData.filter(p => p.theme === t.id).length;
        if (count === 0 && t.id !== 'Concertation citoyenne') return;
        const isActive = t.id === currentTheme;
        const badge = t.id === 'Concertation citoyenne' ? '5 axes' : count;
        html += `<div class="tab ${isActive ? 'active' : ''}" data-theme="${t.id}" onclick="selectTheme('${t.id}')">${t.icon} ${t.label} <span class="badge">${badge}</span></div>`;
    });
    document.getElementById('tabs').innerHTML = html;
}

function render() {
    if (currentTheme === 'Concertation citoyenne') {
        // Afficher bandeau + sous-onglets
        document.getElementById('leitmotiv-banner').classList.add('visible');
        document.getElementById('subtabs-container').classList.add('visible');
        document.getElementById('theme-banner-container').innerHTML = '';
        renderSubtabs();
        renderAxeContent();
    } else {
        // Masquer bandeau + sous-onglets, afficher th√®me classique
        document.getElementById('leitmotiv-banner').classList.remove('visible');
        document.getElementById('subtabs-container').classList.remove('visible');
        renderThemeBanner();
        renderThemeCards();
    }
}

function renderSubtabs() {
    let html = '';
    AXES.forEach(axe => {
        html += `<div class="subtab ${currentAxe === axe.id ? 'active' : ''}" onclick="selectAxe('${axe.id}')">${axe.label}</div>`;
    });
    document.getElementById('subtabs').innerHTML = html;
}

function renderAxeContent() {
    const axe = AXES.find(a => a.id === currentAxe);
    if (!axe) return;
    
    let html = `<div class="axe-content">
        <div class="axe-objectif">
            <h3>üéØ ${axe.titre}</h3>
            <p>${axe.objectif}</p>
        </div>
        <div class="axe-engagements">
            <h4>üå± Nos engagements (${axe.engagements.length})</h4>`;
    
    axe.engagements.forEach(eng => {
        html += `<div class="engagement-item"><h5>${eng.titre}</h5><p>${eng.desc}</p></div>`;
    });
    
    html += `</div></div>`;
    document.getElementById('main-content').innerHTML = html;
}

function renderThemeBanner() {
    const theme = THEMES.find(t => t.id === currentTheme);
    const desc = THEME_DESC[currentTheme] || '';
    document.getElementById('theme-banner-container').innerHTML = `
        <div class="theme-banner">
            <div class="icon">${theme?.icon || 'üìã'}</div>
            <div class="text"><h2>${currentTheme}</h2><p>${desc}</p></div>
        </div>
    `;
}

function renderThemeCards() {
    let filtered = allData.filter(p => p.theme === currentTheme);
    filtered.sort((a, b) => {
        const order = { 'objectif': 0, 'engagement': 1 };
        return (order[a.type] ?? 2) - (order[b.type] ?? 2) || (a.id - b.id);
    });
    
    const objCount = filtered.filter(p => p.type === 'objectif').length;
    const engCount = filtered.filter(p => p.type === 'engagement').length;
    let countText = objCount && engCount ? `${objCount} objectif${objCount > 1 ? 's' : ''} et ${engCount} engagement${engCount > 1 ? 's' : ''}` :
                    objCount ? `${objCount} objectif${objCount > 1 ? 's' : ''}` :
                    engCount ? `${engCount} engagement${engCount > 1 ? 's' : ''}` : `${filtered.length} projet(s)`;
    
    let html = `<div class="results-count">${countText}</div><div class="cards-container"><div class="cards-grid">`;
    
    filtered.forEach(p => {
        const cardClass = p.type === 'objectif' ? 'objectif' : (p.type === 'engagement' ? 'engagement' : '');
        const icon = p.type === 'objectif' ? 'üéØ' : (p.type === 'engagement' ? 'üå±' : 'üìã');
        
        let metaHtml = '';
        if (p.echeance || p.partenaires || p.financement) {
            metaHtml = '<div class="meta">';
            if (p.echeance) metaHtml += `<span>üìÖ ${p.echeance}</span>`;
            if (p.partenaires) metaHtml += `<span>ü§ù ${p.partenaires.substring(0, 50)}${p.partenaires.length > 50 ? '...' : ''}</span>`;
            if (p.financement) metaHtml += `<span>üí∞ ${p.financement.substring(0, 40)}${p.financement.length > 40 ? '...' : ''}</span>`;
            metaHtml += '</div>';
        }
        
        html += `<div class="card ${cardClass}">
            <div class="card-header"><h3>${icon} ${p.titre}</h3></div>
            <div class="card-body">
                <p>${(p.description || p.resume || '').slice(0, 180)}${(p.description || '').length > 180 ? '...' : ''}</p>
                ${metaHtml}
            </div>
        </div>`;
    });
    
    html += `</div></div>`;
    document.getElementById('main-content').innerHTML = html;
}

function selectTheme(theme) {
    currentTheme = theme;
    currentAxe = 'Axe 1';
    renderTabs();
    render();
}

function selectAxe(axe) {
    currentAxe = axe;
    renderSubtabs();
    renderAxeContent();
}

init();
</script>
</body>
</html>
